# Changelog

## [1.4.0] - 2025-02-15

### Added
- Факт-чекинг утверждений из транскрипции (числа, даты, факты о компаниях)
- 3-шаговая архитектура: извлечение → поиск доказательств → синтез вердиктов
- Бесплатный веб-поиск через DuckDuckGo (без API-ключей) для ссылок и факт-чекинга
- Секция "Проверка фактов" в `_analysis.md` и `_analysis.json`
- Вердикты: confirmed / disputed / unverified / likely_false с уверенностью и источниками

### Changed
- Поиск ссылок без API-ключа теперь через DuckDuckGo вместо ненадёжной "памяти модели"
- Обновлены проценты прогресса анализа (саммари → сущности → факт-чекинг → ссылки)

### Removed
- Удалён `_resolve_from_memory` — фоллбэк на "память модели" больше не используется

### Dependencies
- Добавлен `duckduckgo-search>=7.0.0`

---

## [1.3.10] - 2025-02-12

### Fixed
- Добавлено детальное логирование GUI-потока для диагностики неожиданных закрытий
- Логируется весь путь от завершения pipeline до messagebox и закрытия окна
- Обработка исключений в _on_complete для предотвращения "тихих" крэшей

---

## [1.3.9] - 2025-02-12

### Fixed
- Улучшен поиск Claude CLI для macOS/Linux (проверяет npm global пути: /usr/local/bin, ~/.npm-global, ~/.local, nvm)
- Добавлена поддержка NVM_DIR для Node Version Manager на Unix системах

### Added
- Скрипт `check_paths.py` для тестирования кроссплатформенности на любой ОС
- Все пути теперь динамические - приложение работает из любой папки на Windows/macOS/Linux

---

## [1.3.8] - 2025-02-12

### Added
- Логи теперь сохраняются в папку `Logs/` с датой (например, `Logs/transcriber_2025-02-12.log`)
- Логирование непредвиденного закрытия приложения для диагностики
- Обработчик необработанных исключений GUI для предотвращения "тихих" крэшей

### Changed
- Логи доступны пользователям для отправки при ошибках (папка `Logs/` внутри приложения)

---

## [1.3.7] - 2025-02-11

### Changed
- Улучшены промпты AI-анализа для более детального и структурированного вывода
- Саммари теперь содержит тематические разделы с подпунктами и таймстампами [MM:SS]
- Highlights: увеличен лимит (8-20 вместо 3-10), описания стали развёрнутыми
- Entities: более подробный контекст упоминания, привязка спикеров (SPEAKER_XX)

---

## [1.3.6] - 2025-02-09

### Changed
- Диаризация теперь всегда работает на CPU — устраняет hard CUDA crash на длинных файлах
- SpeechBrain ECAPA-TDNN (~25 MB) нормально работает на CPU, CUDA не даёт значимого ускорения
- Убран subprocess-wrapper для диаризации (не нужен без CUDA)

### Fixed
- Исправлены CRLF line endings в `run.bat`

---

## [1.3.4] - 2025-02-09

### Added
- Скрипт автоустановки Windows (`run.bat`): автосоздание venv, установка torch+CUDA, зависимостей
- Скрипт автоустановки macOS/Linux (`run.sh`): автосоздание venv, установка torch CPU, зависимостей

---

## [1.3.3] - 2025-02-09

### Fixed
- CUDA OOM крэш при диаризации длинных файлов (1h+): лимит окон (500 max), прореживание, очистка CUDA cache

---

## [1.3.2] - 2025-02-09

### Fixed
- Промежуточное сохранение JSON сразу после транскрибации — результат не теряется при крэше
- Логирование в файл (`transcriber.log`) — логи сохраняются для диагностики

---

## [1.3.1] - 2025-02-09

### Added
- Подсказка "?" для диаризации (когда включать/отключать)
- Отображение версии и описания приложения внизу окна
- Файл `CHANGELOG.md` для отслеживания изменений

---

## [1.3.0] - 2025-02-09

### Added
- Транскрибация по URL: поддержка YouTube, Vimeo и 1700+ платформ через yt-dlp
- Прогресс скачивания отображается в GUI
- Выходные файлы именуются по названию видео

### Changed
- Поле ввода принимает и файлы, и URL
- Pipeline поддерживает параметр `base_name` для именования выходных файлов

### Dependencies
- Добавлен `yt-dlp>=2024.0.0`

---

## [1.2.0] - 2025-02-08

### Added
- Раздельный MD-экспорт с диаризацией (`_diarized.md`)
- Автоматическая идентификация имён спикеров через Claude CLI
- Подсказка "?" по выбору модели Whisper с рекомендациями по VRAM

### Changed
- Диаризация: переход с pyannote на SpeechBrain (не требует HuggingFace токена)
- Режим повторной обработки (re-processing): диаризация/анализ без повторной транскрибации

---

## [1.1.0] - 2025-02-07

### Added
- AI-анализ через Claude CLI (саммари, ключевые моменты)
- Anthropic API ключ для веб-поиска (опционально)
- Менеджер моделей: скачивание/удаление Whisper моделей
- Логирование, ETA прогресс, graceful fallback при ошибках
- Экспорт в MD (читаемый текст) с контекстом сущностей

### Fixed
- Прогресс-бар, deprecated APIs, CUDA OOM обработка
- Модельный менеджер: TclError, HF token диалог, scrollable layout

---

## [1.0.0] - 2025-02-06

### Added
- Транскрибация видео и аудио через faster-whisper
- Поддержка GPU (CUDA) и CPU
- Экспорт: JSON, SRT, VTT, TXT
- GUI на CustomTkinter
- Автоопределение GPU и рекомендации по моделям
